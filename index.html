<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KLordWeblog</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Long+Cang&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/base/reset.css">
    <link rel="stylesheet" href="styles/components/navbar.css?v=20241223_1922">
    <link rel="stylesheet" href="styles/components/blocks.css">
    <link rel="stylesheet" href="styles/pages/login.css">
    <link rel="stylesheet" href="styles/pages/login-core.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="js/auth/auth-config.js"></script>
    <script src="js/config/app-config.js"></script>
    <script>
        // åŠ è½½GitHubé…ç½®åˆ°å…¨å±€å˜é‡
        fetch('.env')
            .then(response => response.text())
            .then(text => {
                const lines = text.split('\n');
                lines.forEach(line => {
                    const [key, value] = line.split('=');
                    if (key && value && !key.startsWith('#')) {
                        window[key.trim()] = value.trim();
                    }
                });

                // é…ç½®åŠ è½½å®Œæˆåï¼Œè®¾ç½®æ‰€æœ‰å¤´åƒ
                const loginAvatar = document.querySelector('.login-avatar');
                if (loginAvatar && window.DEFAULT_AVATAR) {
                    loginAvatar.src = window.DEFAULT_AVATAR;
                }

                // è®¾ç½®å…³äºé¡µé¢å¤´åƒ
                const aboutAvatar = document.querySelector('.about-content .profile-image img');
                if (aboutAvatar && window.DEFAULT_AVATAR) {
                    aboutAvatar.src = window.DEFAULT_AVATAR;
                }
            })
            .catch(error => {
                console.warn('Failed to load .env file:', error);
                // è®¾ç½®é»˜è®¤å¤´åƒ
                const loginAvatar = document.querySelector('.login-avatar');
                if (loginAvatar) {
                    loginAvatar.src = 'https://ui-avatars.com/api/?name=KLord&size=100&background=4A90E2&color=fff&format=png';
                }
            });
    </script>
</head>
<body>
    <!-- æ·»åŠ èƒŒæ™¯æ•ˆæœå®¹å™¨ -->
    <div class="background-effects"></div>
    <div class="cursor-follower"></div>
    <!-- æ·»åŠ æ¼‚æµ®è£…é¥°å…ƒç´  -->
    <div class="floating-elements">
        <div class="floating-element" style="top: 10%; left: 10%; width: 60px; height: 60px;"></div>
        <div class="floating-element" style="top: 20%; right: 15%; width: 40px; height: 40px;"></div>
        <div class="floating-element" style="bottom: 15%; left: 20%; width: 50px; height: 50px;"></div>
        <div class="floating-element" style="bottom: 25%; right: 10%; width: 45px; height: 45px;"></div>
    </div>
    
    <!-- ç™»å½•éƒ¨åˆ† -->
    <div class="login-container" id="loginSection">
        <div class="login-box">
            <div class="login-header">
                <img src="" alt="å¤´åƒ" class="login-avatar" onerror="this.src='https://ui-avatars.com/api/?name=KLord&size=100&background=4A90E2&color=fff&format=png'">
                <p style="color: rgba(41, 38, 38, 0.8);">åŠæºªæ˜æœˆï¼Œä¸€æ•æ¸…é£</p>
            </div>
            <form id="loginForm" class="login-form">
                <div class="form-group">
                    <i class="fas fa-user"></i>
                    <input type="text" id="username" placeholder="ç”¨æˆ·å" value="KLord">
                </div>
                <div class="form-group">
                    <i class="fas fa-lock"></i>
                    <input type="password" id="password" placeholder="å¯†ç ">
                </div>
                <div class="form-options">
                    <a href="#" class="forgot-password" onclick="showHint(event)" style="text-decoration: none;">æç¤º</a>
                </div>
                <button type="submit" class="login-btn">
                    <span>ç™»å½•</span>
                    <i class="fas fa-arrow-right"></i>
                </button>
            </form>
        </div>
    </div>

    <div id="hintModal" class="hint-modal">
        <div class="hint-content">
            <p>ä¸Šå¤©å‚å…‰å…®ç†™äºˆä»¥é’æ˜¥ï¼Œ</p>
            <p>ä»Šæ—¥ä½•æ—¥å…®å…±æ­¤è‰¯è¾°</p>
        </div>
    </div>

    <!-- ç™»å½•æˆåŠŸåŠ è½½åŠ¨ç”» -->
    <div id="loginLoading" class="login-loading-overlay" style="display: none;">
        <div class="loading">
            <svg width="64px" height="48px">
                <polyline points="0.157 23.954, 14 23.954, 21.843 48, 43 0, 50 24, 64 24" id="back"></polyline>
                <polyline points="0.157 23.954, 14 23.954, 21.843 48, 43 0, 50 24, 64 24" id="front"></polyline>
            </svg>
        </div>
    </div>
    
    <!-- å·¦ä¾§å¯¼èˆªæ  -->
    <nav class="side-nav" id="mainNavigation" style="display: none;">
        <div class="nav-content">
            <div class="profile-section"></div>
            <ul class="nav-links"></ul>
            <button class="learn-more" onclick="logout()">
                <span class="circle" aria-hidden="true">
                    <span class="icon arrow"></span>
                </span>
                <span class="button-text">Logout</span>
            </button>
        </div>
    </nav>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <main class="main-content" id="mainContent" style="display: none;">
        <!-- é¦–é¡µéƒ¨åˆ† -->
        <section id="home" class="section active">
            <div class="container">
                <div class="intro-section">
                    <!-- Loader Animation Background -->
                    <div class="loader">
                      <span><span></span><span></span><span></span><span></span></span>
                      <div class="base">
                        <span></span>
                        <div class="face"></div>
                      </div>
                    </div>
                    <div class="longfazers">
                      <span></span><span></span><span></span><span></span>
                    </div>

                    <h1 class="intro-title">
                        <span class="highlight">Welcome</span>
                    </h1>
                    <div class="intro-subtitle">
                        <button class="button">
                            <div id="clip">
                                <div id="leftTop" class="corner"></div>
                                <div id="rightBottom" class="corner"></div>
                                <div id="rightTop" class="corner"></div>
                                <div id="leftBottom" class="corner"></div>
                            </div>
                            <span id="rightArrow" class="arrow"></span>
                            <span id="leftArrow" class="arrow"></span>
                            <span class="text_button">Full Stack Developer</span>
                        </button>
                    </div>
                    <p class="intro-text">
                        The only way to do <span class="accent">great</span> is to <span class="accent">love</span> what you do.
                    </p>



                    <!-- éŸ³å¾‹è·³åŠ¨ç‰¹æ•ˆ -->
                    <div class="audio-visualizer">
                        <div class="audio-bar"></div>
                        <div class="audio-bar"></div>
                        <div class="audio-bar"></div>
                        <div class="audio-bar"></div>
                        <div class="audio-bar"></div>
                        <div class="audio-bar"></div>
                        <div class="audio-bar"></div>
                        <div class="audio-bar"></div>
                    </div>
                </div>

                <!-- ç²’å­æ¸¸æˆ -->
                <div class="particle-game">
                    <canvas id="particleCanvas"></canvas>
                    <div class="game-info">
                        <span class="game-title">Particle Chaser</span>
                        <span class="game-score">Score: <span id="score">0</span></span>
                    </div>
                </div>

                <!-- ç«™ç‚¹å¯¼èˆªå¡ç‰‡ -->
                <div class="site-section">
                    <div class="site-cards">
                        <a href="#" class="site-card">
                            <div class="card-icon">ğŸ¤–</div>
                            <div class="card-content">
                                <h3>åšå®¢</h3>
                            </div>
                        </a>
                        <a href="#" class="site-card">
                            <div class="card-icon">ğŸ‘»</div>
                            <div class="card-content">
                                <h3>äº‘ç›˜</h3>
                            </div>
                        </a>
                        <a href="https://github.com/K1Super" target="_blank" class="site-card">
                            <div class="card-icon">ğŸ€</div>
                            <div class="card-content">
                                <h3>å®éªŒå®¤</h3>
                            </div>
                        </a>
                        <a href="#" class="site-card">
                            <div class="card-icon">ğŸ”®</div>
                            <div class="card-content">
                                <h3>å·¥å…·ç®±</h3>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- é¡¹ç›®é›†éƒ¨åˆ† -->
        <section id="projects" class="section">
            <div class="container">
                <!-- å³ä¸Šè§’èºä¸è®¾ç½®æŒ‰é’® -->
                <button class="settings-gear" id="settingsGear">
                    <i class="fas fa-cog"></i>
                </button>
                <!-- è®¾ç½®èœå• -->
                <div class="settings-menu" id="settingsMenu">
                    <button class="settings-menu-btn" id="addProjectBtn">
                        <i class="fas fa-plus"></i>
                        <span>å¢åŠ é¡¹ç›®</span>
                    </button>
                    <button class="settings-menu-btn" id="manageProjectBtn">
                        <i class="fas fa-cog"></i>
                        <span>ç®¡ç†é¡¹ç›®</span>
                    </button>
                </div>
                <div class="content-area">
                    <!-- é¡¹ç›®å†…å®¹åŒºåŸŸ -->
                </div>
            </div>
        </section>

        <!-- èµ„æºåº“éƒ¨åˆ† -->
        <section id="resources" class="section">
            <div class="container">
                <div class="content-area">
                    <!-- ç®€æ´æœç´¢ç•Œé¢ -->
                    <div class="resources-search-header">
                        <div class="search-input-container">
                            <input type="text" class="resources-search-input" placeholder="æœç´¢èµ„æº...">
                            <i class="fas fa-search search-icon-left"></i>
                            <button class="add-resource-btn">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>

                    <!-- ç©ºçŠ¶æ€æç¤º -->
                    <div class="resources-empty">
                        <div class="empty-icon">
                            <i class="fas fa-database"></i>
                        </div>
                        <h3>èµ„æºåº“</h3>
                        <p>æš‚æ— èµ„æºï¼Œç‚¹å‡»ä¸Šæ–¹åŠ å·æ·»åŠ æ–°èµ„æº</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- å…³äºæˆ‘éƒ¨åˆ† -->
        <section id="about" class="section">
            <div class="container">
                <div class="about-content">
                    <!-- ç¼–è¾‘æŒ‰é’® -->
                    <button class="about-edit-btn" id="aboutEditBtn" title="ç¼–è¾‘å†…å®¹">
                        <i class="fas fa-edit"></i>
                    </button>
                    <div class="about-profile">
                        <svg class="rocket" viewBox="48.0129 48.1783 416 415.6">
                            <path d="M461.81,53.81a4.4,4.4,0,0,0-3.3-3.39c-54.38-13.3-180,34.09-248.13,102.17a294.9,294.9,0,0,0-33.09,39.08c-21-1.9-42-.3-59.88,7.5-50.49,22.2-65.18,80.18-69.28,105.07a9,9,0,0,0,9.8,10.4l81.07-8.9a180.29,180.29,0,0,0,1.1,18.3,18.15,18.15,0,0,0,5.3,11.09l31.39,31.39a18.15,18.15,0,0,0,11.1,5.3,179.91,179.91,0,0,0,18.19,1.1l-8.89,81a9,9,0,0,0,10.39,9.79c24.9-4,83-18.69,105.07-69.17,7.8-17.9,9.4-38.79,7.6-59.69a293.91,293.91,0,0,0,39.19-33.09C427.82,233.76,474.91,110.9,461.81,53.81ZM298.66,213.67a42.7,42.7,0,1,1,60.38,0A42.65,42.65,0,0,1,298.66,213.67Z"></path>
                        </svg>
                        <div class="profile-image">
                            <img src="" alt="ä¸ªäººç…§ç‰‡" onerror="this.src='https://ui-avatars.com/api/?name=KLord&size=200&background=4A90E2&color=fff&format=png'">
                        </div>
                        <div class="profile-info">
                            <h2>KLord</h2>
                            <p class="subtitle"></p>
                            <p class="bio"></p>
                        </div>
                    </div>
                    <div class="about-sections">
                        <!-- å†…å®¹å°†ç”±JavaScriptåŠ¨æ€åŠ è½½ -->
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- æ±‰å ¡èœå•æŒ‰é’® -->
    <button class="menu-toggle" id="menuToggle" style="display: none;" onclick="toggleMenu()">
        <i class="fas fa-bars"></i>
    </button>

    <!-- è„šæœ¬æ–‡ä»¶ -->
    <script src="js/auth/auth-handler.js"></script>
    <script src="js/auth/login-handler.js"></script>
    <script src="js/animations/login-animation.js"></script>
    <script src="js/components/nav-component.js"></script>
    <script src="js/components/avatar-manager.js"></script>
    <script src="js/components/about-editor.js"></script>
    <script src="js/animations/global.js"></script>
    <script src="js/components/responsive-layout.js"></script>
    <script src="js/components/project-manager.js"></script>
    <script src="js/components/settings-handler.js"></script>
    <script src="js/main.js"></script>
    <script src="js/animations/particle-animation.js"></script>
    <script>
        // æ•´åˆç™»å½•å’Œä¸»é¡µçš„è„šæœ¬
        document.addEventListener('DOMContentLoaded', function() {
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            checkLoginStatus();

            // ç™»å½•è¡¨å•æäº¤å¤„ç†
            document.getElementById('loginForm').addEventListener('submit', function(event) {
                handleLogin(event);
            });

            // åˆå§‹åŒ–ç™»å½•åŠŸèƒ½ï¼ˆåŒ…æ‹¬å›è½¦é”®ç™»å½•ï¼‰
            if (typeof initLoginFeatures === 'function') {
                initLoginFeatures();
            }

            // ä¸éœ€è¦åœ¨è¾“å…¥æ—¶è‡ªåŠ¨æ¸…é™¤é”™è¯¯æç¤ºï¼Œè®©é”™è¯¯æŒç»­æ˜¾ç¤ºç›´åˆ°ç™»å½•æˆåŠŸ
            const usernameInput = document.getElementById('username');
            const passwordInput = document.getElementById('password');

            // ç›‘å¬ç™»å½•çŠ¶æ€å˜åŒ–ï¼Œç”¨äºåˆå§‹åŒ–ç²’å­æ¸¸æˆ
            window.addEventListener('loginStateChanged', function() {
                console.log('ç™»å½•çŠ¶æ€å˜åŒ–ï¼Œæ£€æŸ¥æ˜¯å¦éœ€è¦åˆå§‹åŒ–ç²’å­æ¸¸æˆ');
                if (sessionStorage.getItem('loginStatus') === 'true') {
                    // å»¶è¿Ÿåˆå§‹åŒ–ç²’å­æ¸¸æˆï¼Œç¡®ä¿DOMå·²æ¸²æŸ“
                    setTimeout(() => {
                        if (typeof initParticleGame === 'function') {
                            initParticleGame();
                        }
                    }, 200);
                }
            });
        });
        
        // æ£€æŸ¥ç™»å½•çŠ¶æ€å‡½æ•°
        function checkLoginStatus() {
            const loginStatus = sessionStorage.getItem('loginStatus');
            const loginSection = document.getElementById('loginSection');
            const mainNavigation = document.getElementById('mainNavigation');
            const mainContent = document.getElementById('mainContent');
            const menuToggle = document.getElementById('menuToggle');
            
            if (loginStatus === 'true') {
                // å·²ç™»å½•ï¼Œæ˜¾ç¤ºä¸»é¡µå†…å®¹
                loginSection.style.display = 'none';
                mainNavigation.style.display = 'block';
                mainContent.style.display = 'block';
                menuToggle.style.display = 'block';
                // åˆå§‹åŒ–ä¸»é¡µæ‰€éœ€çš„åŠŸèƒ½
                if (typeof initMainPage === 'function') {
                    initMainPage();
                }
                // è§¦å‘ç™»å½•çŠ¶æ€å˜åŒ–äº‹ä»¶
                window.dispatchEvent(new Event('loginStateChanged'));
            } else {
                // æœªç™»å½•ï¼Œæ˜¾ç¤ºç™»å½•é¡µé¢
                loginSection.style.display = 'flex';
                mainNavigation.style.display = 'none';
                mainContent.style.display = 'none';
                menuToggle.style.display = 'none';
            }
        }
        
        // é€€å‡ºç™»å½•å‡½æ•°
        function logout() {
            sessionStorage.clear();
            checkLoginStatus();
        }
    </script>

</body>
</html>
